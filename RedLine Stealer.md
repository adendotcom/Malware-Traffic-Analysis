&nbsp;

## Introduction

Redline Stealer is a type of Infostealer malware, which aims to steal sensitive information such as saved credentials, cookies, credit card information and more.

&nbsp;

In this writeup, I  will perform a packet capture analysis of the malware using a pcap file provided by [Palo Alto](https://unit42.paloaltonetworks.com/wireshark-quiz-redline-stealer/)

&nbsp;

## Scenario

Traffic for this quiz occurred in an Active Directory (AD) environment during July 2023. Details of the local area network (LAN) environment for the pcap follow.

**Local Area Network (LAN) Details**

- LAN segment range: 10.7.10\[.\]0/24 (10.7.10\[.\]1 through 10.7.10\[.\]255)
- Domain: coolweathercoat\[.\]com
- Domain controller IP address: 10.7.10\[.\]9
- Domain controller hostname: WIN-S3WT6LGQFVX
- LAN segment gateway: 10.7.10\[.\]1
- LAN segment broadcast address: 10.7.10\[.\]255

&nbsp;

&nbsp;

&nbsp;

## Beginning Our Analysis

### **Suspicious DNS Queries**

Looking for DNS type A queries, I came across a suspicious domain: 623start\[.\]site  
![image](https://github.com/user-attachments/assets/f1119930-4a15-4aab-90a8-d1bd7c904959)

We can see from the VirusTotal Analysis that the domain is malicious as 12 vendors as claimed the domain to be "Malware" with 1 claiming it as "Suspicious":

![image](https://github.com/user-attachments/assets/15b220c6-b68a-46a8-9a3b-62274689db23)

&nbsp;

### **HTTP Requests Analysis**

Now filtering for packets where http.host is the suspicious domain we see some strange GET requests:

![image](https://github.com/user-attachments/assets/1ba94f54-d29e-4587-8ce1-d1609d0ff892)

&nbsp;

![image](https://github.com/user-attachments/assets/79ddef84-acc6-4453-ae7f-ad51b09675c6)

&nbsp;

![image](https://github.com/user-attachments/assets/89bf4140-98fb-4dee-946c-fe6c53666650)

&nbsp;

### **Network Traffic**

And looking at the Conversations tab, I discovered a large volume of traffic to 194\[.\]26\[.\]135\[.\]119 and guiatelefonos\[.\]com

![image](https://github.com/user-attachments/assets/f9fcf8b0-9857-4d19-bfba-73d88b491b1f)

&nbsp;

Narrowing research to network traffic between the host and the ip address 194\[.\]26\[.\]135\[.\]119

![image](https://github.com/user-attachments/assets/cc5500b3-19a0-454b-b7e4-556c3a28a704)

&nbsp;

### **TCP stream analysis**

Following the TCP stream, I can see that the malware is trying to obtain information such as crypto wallets, files from Desktop and Documents, Crypto wallets, user data from browsers, and API keys:

![image](https://github.com/user-attachments/assets/747450d0-8256-49d9-954a-4c9ec3d352f3)

&nbsp;

![image](https://github.com/user-attachments/assets/a7645433-cd06-4340-b6e8-eb15f5b9c081)

&nbsp;

&nbsp;

### **User account name discovery**

I created a new column called CNameString and filtered for  kerberos.CNameString in order to find the user account name associated with the infected host, which was "rwalters"

![image](https://github.com/user-attachments/assets/4d1f8d00-e5fe-47bc-93b5-8096657a9508)

&nbsp;

### **Summary of Findings based on [Quiz questions](https://unit42.paloaltonetworks.com/wireshark-quiz-redline-stealer/)**

- **Date and time of infection (UTC):** 2023-07-10 22:39
- **IP address of the infected Windows client:** 10.7.10.47
- **MAC address of the infected Windows client:** 80:86:5b:ab:1e:c4
- **Hostname of the infected Windows client:** DESKTOP-9PEA63H
- **User account name from the infected Windows host:** rwalters
- **Type of information RedLine Stealer tried to steal:** Files, Cryptowallets, user data from browsers.
